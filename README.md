# Unsupervised Depth Predictors

This repository is to tweak the official codes of several unsupervised deep learning depth predictiors to facilitate private applications:
- **struc2depth**:  
    - paper: [Depth Prediction Without the Sensors: Leveraging Structure for Unsupervised Learning from Monocular Videos](https://arxiv.org/abs/1811.06152)
    - codes: [tensorflow/models, commit 36101ab](https://github.com/tensorflow/models/tree/36101ab4095065a4196ff4f6437e94f0d91df4e9)
- **vid2depth**:
    - paper: [Unsupervised Learning of Depth and Ego-Motion from Monocular Video Using 3D Geometric Constraints](https://arxiv.org/abs/1802.05522)
    - codes: [tensorflow/models, commit 37ec178](https://github.com/tensorflow/models/tree/37ec31714f68255532b4c35f117bc33fd7f90692)
- **depth_from_video_in_the_wild**:
    - paper: [Depth from Videos in the Wild: Unsupervised Monocular Depth Learning from Unknown Cameras](https://arxiv.org/abs/1904.04998?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%253A+arxiv%252FQSXk+%2528ExcitingAds%2521+cs+updates+on+arXiv.org%2529)
    - codes: [google-research/google-research, commit 57b6017](https://github.com/google-research/google-research/tree/57b60e7a7a5efc358adf4041a062ae435e6155be)
- **depth_and_motion_learning**: 
    - paper: [Unsupervised Monocular Depth Learning in Dynamic Scenes](https://arxiv.org/abs/2010.16404)
    - codes: [google-research/google-research, commit 57b6017](https://github.com/google-research/google-research/tree/57b60e7a7a5efc358adf4041a062ae435e6155be)

The codes to generate segmentation masks of the training images in order to learn object motions are based on [**matterport/Mask_RCNN**](https://github.com/matterport/Mask_RCNN/tree/3deaec5d902d16e1daf56b62d5971d428dc920bc); the Tensorflow ResNet-18 checkpoint trained on ImageNet is generated by referring to [**dalgu90/resnet-18-tensorflow**](https://github.com/dalgu90/resnet-18-tensorflow/tree/49eb67c3c57258537c0dcbab5cdf2c38bb1af776)

## KITTI Data Preparation
**Download Raw Data**

```shell
$ ./kitti_raw_downloader.sh full_version
```
The downloaded data is put in `KITTI_raw` directory with the following structure:
```
KITTI_raw/
└── 2011_09_26
    ├── 2011_09_26_drive_0001_sync
    │   ├── image_00
    │   ├── image_01
    │   ├── image_02
    │   ├── image_03
    │   ├── oxts
    │   └── velodyne_points
    ├── calib_cam_to_cam.txt
    ├── calib_imu_to_velo.txt
    └── calib_velo_to_cam.txt
```

**Convert Raw Images to Training Data**


## Data Preparation from Your Own Videos


## Model Training
- struct2depth:
```
$
```
- vid2depth:
```
$
```
- depth_from_video_in_the_wild:
```
$
```
- depth_and_motion_learning:
```
$
```

## Inference
